# Table: oci_adm_vulnerability_audit

A Vulnerability Audit associates the Application Dependencies of a project with their associated Vulnerabilities. Each Vulnerability is associated with a score (Common Vulnerability Scoring System V2 or V3). A vulnerable Application Dependency can be ignored based on the configuration of the Vulnerability Audit. `maxObservedCvssV2Score`, `maxObservedCvssV3Score` and `vulnerableArtifactsCount` do not take into account non-vulnerable Application Dependency.

## Examples

### Basic info

```sql
select
  id,
  knowledge_base_id,
  vulnerabilities,
  max_observed_cvss_v2_score,
  max_observed_cvss_v3_score,
  max_observed_cvss_v2_score_with_ignored,
  max_observed_cvss_v3_score_with_ignored,
  vulnerable_artifacts_count_with_ignored,
  vulnerable_artifacts_count,
  build_type,
  display_name,
  is_success,
  lifecycle_state as state
from
  oci_adm_vulnerability_audit;
```

### List vulnerability audits which are not active

```sql
select
  id,
  knowledge_base_id,
  vulnerabilities,
  max_observed_cvss_v2_score,
  max_observed_cvss_v3_score,
  max_observed_cvss_v2_score_with_ignored,
  max_observed_cvss_v3_score_with_ignored,
  vulnerable_artifacts_count_with_ignored,
  vulnerable_artifacts_count,
  build_type,
  display_name,
  is_success,
  lifecycle_state as state
from
  oci_adm_vulnerability_audit
where
  lifecycle_state <> 'ACTIVE';
```

### List vulnerability audits created in last 30 days

```sql
select
  id,
  knowledge_base_id,
  vulnerabilities,
  max_observed_cvss_v2_score,
  max_observed_cvss_v3_score,
  max_observed_cvss_v2_score_with_ignored,
  max_observed_cvss_v3_score_with_ignored,
  vulnerable_artifacts_count_with_ignored,
  vulnerable_artifacts_count,
  build_type,
  display_name,
  is_success,
  lifecycle_state as state
from
  oci_adm_vulnerability_audit
where
  time_created >= now() - interval '30' day;
```

### List successful vulnerability audits

```sql
select
  id,
  knowledge_base_id,
  vulnerabilities,
  max_observed_cvss_v2_score,
  max_observed_cvss_v3_score,
  max_observed_cvss_v2_score_with_ignored,
  max_observed_cvss_v3_score_with_ignored,
  vulnerable_artifacts_count_with_ignored,
  vulnerable_artifacts_count,
  build_type,
  display_name,
  is_success,
  lifecycle_state as state
from
  oci_adm_vulnerability_audit
where
  is_success;
```

### List vulnerability audits with unknown source

```sql
select
  id,
  knowledge_base_id,
  vulnerabilities,
  source ->> 'type' as source_type,
  vulnerable_artifacts_count,
  build_type,
  display_name,
  is_success,
  lifecycle_state as state
from
  oci_adm_vulnerability_audit
where
  source ->> 'type' = 'UNKNOWN';
```

### List vulnerable events that occurred over the last five minutes

```sql
select
  id,
  knowledge_base_id,
  vulnerabilities,
  max_observed_cvss_v2_score,
  max_observed_cvss_v3_score,
  max_observed_cvss_v2_score_with_ignored,
  max_observed_cvss_v3_score_with_ignored,
  vulnerable_artifacts_count_with_ignored,
  vulnerable_artifacts_count,
  build_type,
  display_name,
  is_success,
  lifecycle_state as state
from
  oci_adm_vulnerability_audit
where
  time_created >= now() - interval '5 minutes'
  and vulnerabilities is not null;
```
